# ADR-0006: Audio Completion Notifications

## Status

Accepted

## Context

Chief runs autonomously, potentially for extended periods. Users may work on other tasks and need to know when the agent loop completes.

Notification options:

1. **Visual only**: Easy but requires watching the terminal
2. **System notifications**: Platform-dependent, often disabled
3. **Audio**: Universally noticeable, works in background

## Decision

Play an embedded audio notification when any PRD completes using `oto/v2`.

## Implementation

```go
// internal/notify/sound.go
//go:embed complete.wav
var completionSound []byte

func (n *Notifier) PlayCompletion() {
    go func() {
        n.playWAV(completionSound)
    }()
}
```

The sound is:
- ~17KB WAV file (mono, 22050Hz, 16-bit)
- C major chord chime with decay (0.4s)
- Generated by `gen_wav.go` utility

## Rationale

1. **Attention**: Audio notifications work even when not looking at the terminal.

2. **Cross-platform**: `oto/v2` supports macOS, Windows, and Linux.

3. **Embedded**: No external dependencies, single binary distribution.

4. **Non-blocking**: Plays in a goroutine, doesn't block the TUI.

## Platform Considerations

| Platform | Audio Backend | CGO Required |
|----------|---------------|--------------|
| macOS | AudioToolbox | No (purego) |
| Windows | WinMM | No (syscalls) |
| Linux | ALSA | Yes |

For Linux without CGO, a stub implementation logs a warning.

## Consequences

### Positive

- Works from background
- Small embedded file (~17KB)
- Easy to disable (`--no-sound`)
- Plays for any PRD completion (not just current)

### Negative

- CGO required on Linux for full support
- No audio on headless systems
- Binary size slightly larger

## Build Tags

```go
//go:build darwin || windows || (linux && cgo)
package notify
```

And a fallback:
```go
//go:build linux && !cgo
package notify
// Stub implementation
```

## References

- [oto](https://github.com/hajimehoshi/oto)
- `internal/notify/sound.go` - Audio implementation
- `internal/notify/wav.go` - WAV file generation
